<?phpinclude '../../classes/config.php';include '../includes/sessao.php';$ativa = 'Home';$subativo = 'Configurações';Log::grava('Acesso Configurações');?><!DOCTYPE html><html lang="pt-br">	<head>	    <base href="<?=DASHBOARD?>">		<meta charset="utf-8" />		<title><?=TITULO?></title>		<meta name="description" content="<?=TITULO?>" />		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />		<link rel="canonical" href="<?=DASHBOARD?>" />		<!--begin::Fonts-->		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" />		<!--end::Fonts-->		<!--begin::Page Vendors Styles(used by this page)-->		<link href="assets/plugins/custom/fullcalendar/fullcalendar.bundle.css" rel="stylesheet" type="text/css" />		<!--end::Page Vendors Styles-->		<!--begin::Global Theme Styles(used by all pages)-->		<link href="assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />		<link href="assets/plugins/custom/prismjs/prismjs.bundle.css" rel="stylesheet" type="text/css" />		<link href="assets/css/style.bundle.css" rel="stylesheet" type="text/css" />		<link href="assets/plugins/custom/datatables/datatables.bundle.css" rel="stylesheet" type="text/css">		<?php include '../includes/tags.php'; ?>		<style>		    <style>		   .card-template1, .card-template2, .card-template3, .card-template4 {		       text-align:center;		   }		   .card-template1 .card-title{ font-size:14px; }		   .card-template2 .card-title{ font-size:14px; }		   .card-template3 .card-title{ font-size:14px; }		   .card-template4 .card-title{ font-size:14px; }		   .card-template1 img{ height:200px; }		   .card-template2 img{ height:200px; }		   .card-template3 img{ height:200px; }		   .card-template4 img{ height:200px; }		   .card-template1 button{ width:70%; }		   .card-template2 button{ width:70%; }		   .card-template3 button{ width:70%; }		   .card-template4 button{ width:70%; }		</style>		<style>            .preloader {                position: fixed;                width: 100vw;                height: 100vh;                text-align: center;                display:none;                overflow: hidden;                z-index: 9999;                background-color: rgba(255, 255, 255, 0.8);            }            .preloaderImagem {                width: 50%;                height: 100vh;                margin: auto;                text-align: center;                padding: 21% 0;            }            .preloaderImagem img{ width:10%; }             .btn-fechar{                z-index: 9999999;                position: absolute;                top: unset !important;                left: 0px;                right: unset !important;                cursor: pointer;                transform: scale(1);                transition: all 0.7s ease 0s;                bottom: 0px;                font-size:13px !important;                padding: 10px 24px;                background-color: red !important;                color:white !important;                border-top-left-radius: 0 !important;                border-top-right-radius: 5px;                box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 24px 2px;                font-weight:bold;            }            .btn-fechar i{                color:white !important;                font-size:13px !important;            }            .format ul {              list-style-type: none;              display:flex;            }                        .format  li {              display: inline-block;              width:25%;              height:150px;            }            .label-img{                width:100%;                 height:150px;                 text-align:center;                line-height: 150px;            }            .label-title{ text-align:center; font-weight:bold; }                input[type="checkbox"][id^="cb"] {                  display: none;            }                        .format label {                height:110px;                  border: 1px solid #fff;                  padding: 10px;                  display: block;                  position: relative;                  margin: 10px;                  cursor: pointer;                  -webkit-touch-callout: none;                  -webkit-user-select: none;                  -khtml-user-select: none;                  -moz-user-select: none;                  -ms-user-select: none;                  user-select: none;            }            .formato-active{                background: #f7f7f7;                border: 1px solid #83f277 !important;            }            .format{ width:100%; }            .formato{                 width:90%;                 margin: 0 5%;                 border: 1px solid #f7f7f7;                height:200px;                cursor:pointer;                border-radius:15px;            }            .formato:hover{                 background: #f7f7f7;            }            #form{ width:100%; }		</style>		</style>	</head>	<!--end::Head-->	<!--begin::Body-->	<body id="kt_body" class="header-fixed header-mobile-fixed header-bottom-enabled page-loading">		<!--begin::Main-->		<!--begin::Header Mobile-->		<div id="kt_header_mobile" class="header-mobile bg-primary header-mobile-fixed">			<!--begin::Logo-->			<a href="">				<img alt="Logo" src="<?=LOGOTIPO?>" class="max-h-30px" />			</a>			<!--end::Logo-->			<!--begin::Toolbar-->			<div class="d-flex align-items-center">				<button class="btn p-0 burger-icon burger-icon-left ml-4" id="kt_header_mobile_toggle">					<span></span>				</button>				<button class="btn p-0 ml-2" id="kt_header_mobile_topbar_toggle">					<span class="svg-icon svg-icon-xl">						<!--begin::Svg Icon | path:assets/media/svg/icons/General/User.svg-->						<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">							<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">								<polygon points="0 0 24 0 24 24 0 24" />								<path d="M12,11 C9.790861,11 8,9.209139 8,7 C8,4.790861 9.790861,3 12,3 C14.209139,3 16,4.790861 16,7 C16,9.209139 14.209139,11 12,11 Z" fill="#000000" fill-rule="nonzero" opacity="0.3" />								<path d="M3.00065168,20.1992055 C3.38825852,15.4265159 7.26191235,13 11.9833413,13 C16.7712164,13 20.7048837,15.2931929 20.9979143,20.2 C21.0095879,20.3954741 20.9979143,21 20.2466999,21 C16.541124,21 11.0347247,21 3.72750223,21 C3.47671215,21 2.97953825,20.45918 3.00065168,20.1992055 Z" fill="#000000" fill-rule="nonzero" />							</g>						</svg>						<!--end::Svg Icon-->					</span>				</button>			</div>			<!--end::Toolbar-->		</div>		<!--end::Header Mobile-->		<div class="d-flex flex-column flex-root">			<!--begin::Page-->			<div class="d-flex flex-row flex-column-fluid page">				<!--begin::Wrapper-->				<div class="d-flex flex-column flex-row-fluid wrapper" id="kt_wrapper">					<?php include '../includes/header.php'; ?>					<!--begin::Content-->					<div class="content d-flex flex-column flex-column-fluid" id="kt_content">						<!--begin::Entry-->						<div class="d-flex flex-column-fluid">							<!--begin::Container-->							<div class="container">								<!--begin::Card-->								<div class="row subheader-internas">								    <div class="col-xl-12">    								    <div class="subheader-background" style="position: relative; background:url(<?=BASE?>imagens/agendar.jpg)">    								    </div>    								    <div class="subheader-titulo">        							        <h1>Configurações</h1>        							        <h3></h3>    						            </div>    						        </div>								</div>                                <div class="row">                                	<div class="col-xl-12">                                		<!--begin::Base Table Widget 2-->                                        <div class="card card-custom card-stretch gutter-b">                                            <!--begin::Header-->                                            <div class="card-header border-0 pt-5">                                                <h3 class="card-title align-items-start flex-column">                                                    <span class="card-label font-weight-bolder text-dark">Configurações</span>                                                </h3>                                                <hr>                                            </div>                                            <!--end::Header-->                                                                                    <!--begin::Body-->                                            <div class="card-body">                                                <form id="form">                								    <div class="row">                                                    	<div class="col-xl-6">                                                    	    <div class="form-group">                    				                            <label>Username (nome de identificação nas urls de Landing Pages & cartões)</label>                                                        		<div class="input-group">                        				                            <div class="input-group-prepend"><span class="input-group-text"><?=BASE?></span></div>                                                        		                                                            		    <input type="text" class="form-control" id="codigo" name="codigo" minlength="4" pattern="[a-z0-9_]+" value="<?=$corretora->codigo?>" required>                                                        		</div>                                                        		<span class="form-text text-muted">São aceitos letras, números e underline.</span>                                                        	</div>                                                    	</div>                                                    	<div class="col-xl-6">                                                    		<div class="form-group">                                                    		    <label>Whatsapp</label>                                                    		    <input type="text" class="form-control telefone" id="whatsapp" name="whatsapp" value="<?=$corretora->whatsapp?>" required>                                                    		</div>                                                    	</div>                                                    	<div class="col-xl-6">                                                        	<div class="form-group">                                                                <label>Logotipo</label>                                                                <? if(!empty($corretora->logotipo)) { ?>            														<img style='width:100%' class="imagem" src="<?=BASE?>imagens/<?=$corretora->logotipo?>" alt="" />            														<input type="hidden" id="logotipo" name="logotipo" value="<?=$corretora->logotipo?>">            													<? } else { ?>                                                            	<input type="hidden" id="logotipo" name="logotipo">                                                            	<? } ?>                        										<div id="dZUpload" class="dropzone dropzone-default dropzone-success dz-clickable">                        									        <div class="dz-default dz-message">Arraste e solte aqui <b>Logotipo</b>(244x60)</div>                        										</div>                        										<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">                        											<div class="modal-dialog" role="document">                        												<div class="modal-content">                        													<div class="modal-header">                        														<h5 class="modal-title" id="modalLabel">Logotipo(244x60)</h5>                        														<button type="button" class="close" data-dismiss="modal" aria-label="Close">                        															<span aria-hidden="true">&times;</span>                        														</button>                        													</div>                        													<div class="modal-body">                        														<div class="img-container">                        															<img id="image" src="../../../imagens/corretora-logotipo.jpg" alt="Picture">                        														</div>                        													</div>                        													<div class="modal-footer">                        														<button id="cancel-upload" type="button" class="btn btn-default" data-dismiss="modal">Close</button>                        														<button id="crop-upload" type="button" class="btn btn-primary" data-dismiss="modal">Upload</button>                        													</div>                        												</div>                        											</div>                        										</div>                                                            </div>                                                        </div>                                                        <div class="col-md-12">                                                            <button type="submit" class="btn btn-mapfre btn-salvar">Salvar</button>                                                        </div>                                                    </div>                                                </form>                                            </div>                                        </div>                                    </div>                                </div>							</div>							<!--end::Container-->						</div>						<!--end::Entry-->					</div>					<!--end::Content-->					<!--begin::Footer-->					<?php include '../includes/footer.php'; ?>					<!--end::Footer-->				</div>				<!--end::Wrapper-->			</div>			<!--end::Page-->		</div>		<!--end::Main-->        <?php  include '../includes/quickUser.php'; ?>		<!--begin::Scrolltop-->		<?php include '../includes/scrollToTop.php'; ?>		<!--end::Scrolltop-->        <!-- Modal-->		<!--begin::Global Config(global config for global JS scripts)-->		<script>var KTAppSettings = { "breakpoints": { "sm": 576, "md": 768, "lg": 992, "xl": 1200, "xxl": 1200 }, "colors": { "theme": { "base": { "white": "#ffffff", "primary": "#6993FF", "secondary": "#E5EAEE", "success": "#1BC5BD", "info": "#8950FC", "warning": "#FFA800", "danger": "#F64E60", "light": "#F3F6F9", "dark": "#212121" }, "light": { "white": "#ffffff", "primary": "#E1E9FF", "secondary": "#ECF0F3", "success": "#C9F7F5", "info": "#EEE5FF", "warning": "#FFF4DE", "danger": "#FFE2E5", "light": "#F3F6F9", "dark": "#D6D6E0" }, "inverse": { "white": "#ffffff", "primary": "#ffffff", "secondary": "#212121", "success": "#ffffff", "info": "#ffffff", "warning": "#ffffff", "danger": "#ffffff", "light": "#464E5F", "dark": "#ffffff" } }, "gray": { "gray-100": "#F3F6F9", "gray-200": "#ECF0F3", "gray-300": "#E5EAEE", "gray-400": "#D6D6E0", "gray-500": "#B5B5C3", "gray-600": "#80808F", "gray-700": "#464E5F", "gray-800": "#1B283F", "gray-900": "#212121" } }, "font-family": "Poppins" };</script>		<!--end::Global Config-->		<!--begin::Global Theme Bundle(used by all pages)-->		<script src="assets/plugins/global/plugins.bundle.js"></script>		<script src="assets/plugins/custom/prismjs/prismjs.bundle.js"></script>		<script src="assets/js/scripts.bundle.js"></script>		<!--end::Global Theme Bundle-->		<!--begin::Page Scripts(used by this page)-->		<script src="assets/js/pages/widgets.js"></script>		<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>		<!--end::Page Scripts-->        <!--begin::Page Scripts(used by this page)-->        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js" integrity="sha512-pHVGpX7F/27yZ0ISY+VVjyULApbDlD0/X0rgGbTqCE7WFW5MezNTWG/dnhtbBuICzsd0WQPgpE4REBLv+UqChw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cropper/1.0.1/jquery-cropper.min.js" integrity="sha512-V8cSoC5qfk40d43a+VhrTEPf8G9dfWlEJgvLSiq2T2BmgGRmZzB8dGe7XAABQrWj3sEfrR5xjYICTY4eJr76QQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>        <script src="assets/js/pages/crud/file-upload/dropzonejs.js?v=7.2.9"></script>        <script src="https://cdnjs.cloudflare.com/ajax/libs/cropper/4.1.0/cropper.min.js" integrity="sha512-E+gDQcIvNXE60SjCS38ysf1mGh4ObBpKcUOp0oEaHQHQAdaN2p7GelOpgEdpTuCLoIJyLkNXiqFZbyD9Ak/Ygw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropper/4.1.0/cropper.css" integrity="sha512-iAcZ4OrGhQ7KDqtM+LMc+iuv63aJ9O7hPyWBzCXsrZYuhJ6jhdeh40+hf9o4QmZVu8QrH/cWy/JTmoKNOL4Urw==" crossorigin="anonymous" referrerpolicy="no-referrer" />        <!--end::Page Vendors-->                 <!--begin::Page Scripts(used by this page)-->        <script src="assets/js/pages/features/miscellaneous/cropper.js?v=7.2.9"></script>        <script>                    function popupTSSD(){                let timerInterval;                Swal.fire({                    icon: "info",                    title: "Transparência e Segurança dos Seus Dados",                    html: "A MAPFRE reforça seu compromisso com a privacidade e a segurança das informações. Nenhum dado inserido nesta plataforma será exportado ou utilizado pela MAPFRE para qualquer outro fim. Toda a gestão das informações é de responsabilidade exclusiva da corretora.<br> Fique tranquilo: seus dados e os de seus clientes estão protegidos. <br><br>Essa Popup irá ser fechada em <b></b>",                    showConfirmButton: false,                    timer: 5000,                    timerProgressBar: true,                    width: 600,                    height:600,                    didOpen: () => {                        Swal.showLoading();                        const timer = Swal.getPopup().querySelector("b");                        timerInterval = setInterval(() => {                          timer.textContent = `${Swal.getTimerLeft()}`;                        }, 100);                    },                    willClose: () => {                        clearInterval(timerInterval);                    }                });            }            var SPMaskBehavior = function(val){              return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';            },            spOptions = {              onKeyPress: function(val, e, field, options) {                  field.mask(SPMaskBehavior.apply({}, arguments), options);                }            };            $('.telefone').mask(SPMaskBehavior, spOptions);                        $("#form").submit(function(e){                $(".btn-salvar").text("Aguarde...").attr("disabled",true);                e.preventDefault();                var formDados = $(this).serialize();                $.ajax({                    type: "POST",                    dataType: "json",                    url: "configuracoes/actions/configuracao.php",                    processData: true,                    data: formDados,                      success: function(data){                        if(data.sucesso == true){                            Swal.fire("Salvo!", 'Dados salvos com sucesso', "success");                            $(".btn-salvar").text("Salvar").attr("disabled",false);                        } else if(data.sucesso == false){                            Swal.fire("Erro!", data.erro, "error");                            $(".btn-salvar").text("Salvar").attr("disabled",false);                        }                     },                    error: function (exr, sender) {                        Swal.fire("Erro!", 'Ocorreu um erro no sistema', "error");                        $(".btn-salvar").text("Salvar").attr("disabled",false);                    }                });             });            $("#codigo").blur(function(){                codigo = $("#codigo").val();                $.ajax({                    type: "POST",                    dataType: "json",                    url: "configuracoes/actions/username.php",                    processData: true,                    data: {codigo:codigo},                      success: function(data){                        if(data.sucesso == true){                            $("#codigo").val(data.username);                        } else if(data.sucesso == false){                            Swal.fire("Erro!", data.erro, "error");                            $("#codigo").val('');                        }                     },                    error: function (exr, sender) {                        Swal.fire("Erro!", 'Ocorreu um erro no sistema', "error");                        $(".btn-salvar").text("Salvar").attr("disabled",false);                    }                });             });		</script>		<script>		    Dropzone.autoDiscover = false;            $(document).ready(function(){    			var myDropzone = new Dropzone(    					"#dZUpload",    					{    						autoProcessQueue: true,    						paramName: "file",    						url: "estrategias/actions/upload.php",    						acceptedFiles: ".jpg,.png,.jpeg",    						maxFiles: 1,    						maxFilesize: 5,    						addRemoveLinks: true,    						success: function (file, response) {    						    popupTSSD();    							fileNameImagem = response;    							console.log("Successfully uploaded : " + fileNameImagem);    							$("#logotipo").val(fileNameImagem);    						},    						error: function (file, response) {    							console.log(response + '('+ file.name +')');    						}    					}    			);                myDropzone.on('thumbnail', function (file) {    				if (file.cropped) {    					return;    				}        				var cachedFilename = file.name;    				myDropzone.removeFile(file);        				var $cropperModal = $('#modal');    				var $uploadCrop = $cropperModal.find('#crop-upload');    				var $cancelCrop = $cropperModal.find('#cancel-upload');    				var $img = $('#image');        				var reader = new FileReader();    				reader.onloadend = function () {        						$cropperModal.find('.image-container').html($img);    						$img.attr('src', reader.result);        						$img.cropper({    						        aspectRatio: 122/33,    								autoCropArea: 1,    								movable: true,    								cropBoxResizable: true,    								minContainerHeight : 400,    								minContainerWidth : 450    						});    				};        				reader.readAsDataURL(file);    				$cropperModal.modal({backdrop: 'static', keyboard: false});        				$uploadCrop.on('click', function() {    						myDropzone.removeAllFiles(true)    						var blob = $img.cropper(    							'getCroppedCanvas',    							{    								width: 244, //LARGURA DA IMAGEM AQUI    								height: 60 //ALTURA DA IMAGEM    							}    						).toDataURL();    						// transform it to Blob object    						var newFile = dataURItoBlob(blob);    						// set 'cropped to true' (so that we don't get to that listener again)    						newFile.cropped = true;    						// assign original filename    						newFile.name = cachedFilename;    						// add cropped file to dropzone    						myDropzone.addFile(newFile);    						// upload cropped file with dropzone    						myDropzone.processQueue();    						$cropperModal.modal('hide');        						setTimeout(() => {    							$img.cropper("destroy");    						});    				});            				$cancelCrop.on('click', function() {    					$img.cropper("destroy");    					myDropzone.removeAllFiles(true)    				})        				function dataURItoBlob(dataURI) {    						var byteString = atob(dataURI.split(',')[1]);    						var ab = new ArrayBuffer(byteString.length);    						var ia = new Uint8Array(ab);    						for (var i = 0; i < byteString.length; i++) {    								ia[i] = byteString.charCodeAt(i);    						}    						return new Blob([ab], { type: 'image/jpeg' });    				}    			});            });		</script>	</body>	<!--end::Body--></html>